<% provide :title, @with.name %>
<h1><%= yield(:title) %></h1>

<p><%= t('New ', model: t('activerecord.models.message')) %></p>
<%= form_for(@message) do |f| %>
  <ul data-role="listview" data-inset="true">
    <%= f.hidden_field :to_id %>
    <li data-role="fieldcontaion">
      <%= f.label :subject %>
      <%= f.text_field :subject %>
    </li>
    <li data-role="fieldcontaion">
      <%= f.label :body %>
      <%= f.text_area :body %>
    </li>
    <li>
      <%= f.submit t("Submit new message") %>
    </li>
  </ul>
<% end %>
<hr>

<% if @message.present? %>
  <% @messages.each do |message| %>
  <% message.direction == "to" ? float = "left" : float = "right" %>
  <div class="ui-shadow ui-btn-corner-all ui-btn-up-c message-<%= float %>">
    <strong><%= message.subject %></strong>
    <p><%= simple_format message.body %></p>
    <p><%= l(message.created_at) %></p>
  </div>
  <% end %>
  <br style="clear: both;">
<% else %>
  <p><%= t("There is no ", model: t('activerecord.models.message')) %></p>
<% end %>